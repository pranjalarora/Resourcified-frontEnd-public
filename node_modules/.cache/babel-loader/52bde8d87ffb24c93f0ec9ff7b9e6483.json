{"ast":null,"code":"import _classCallCheck from\"/home/parth/Documents/Github/resourcified-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/parth/Documents/Github/resourcified-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/parth/Documents/Github/resourcified-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/parth/Documents/Github/resourcified-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import axios from\"axios\";import{Link,Redirect}from\"react-router-dom\";import TitleComponent from\"./title\";import configData from\"./config.json\";var Login=/*#__PURE__*/function(_Component){_inherits(Login,_Component);var _super=_createSuper(Login);function Login(){var _this;_classCallCheck(this,Login);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={email:\"\",password:\"\",redirect:false,authError:false,isLoggedin:false,location:{}};_this.handleEmailChange=function(event){_this.setState({email:event.target.value});};_this.handlePwdChange=function(event){_this.setState({password:event.target.value});};_this.handleSubmit=function(event){event.preventDefault();_this.setState({isLoading:true});var options={headers:{\"Content-Type\":\"application/json\"}};var url=\"\".concat(configData.SERVER_URL,\"api/login\");var email=_this.state.email;var password=_this.state.password;var bodyFormData=new FormData();bodyFormData.set(\"email\",email);bodyFormData.set(\"password\",password);axios.post(url,bodyFormData).then(function(result){console.log(result.data);localStorage.setItem(\"userid\",result.data.id);localStorage.setItem(\"token\",result.data.token);localStorage.setItem(\"role\",result.data.role);console.log(localStorage.getItem(\"role\"));localStorage.setItem(\"institute\",result.data.institute);localStorage.setItem(\"branch\",result.data.branch);localStorage.setItem(\"full_name\",result.data.full_name);_this.setState({redirect:true,isLoggedin:true});localStorage.setItem(\"isLoggedIn\",true);if(result.data.status!==\"fail\"){_this.setState({redirect:true,authError:false});}else{_this.setState({redirect:false,authError:true});}}).catch(function(error){console.log(error);_this.setState({authError:true,isLoading:false});});};_this.renderRedirect=function(){if(_this.state.redirect){return/*#__PURE__*/React.createElement(Redirect,{to:\"/branches\"});}};return _this;}_createClass(Login,[{key:\"render\",value:function render(){var isLoading=this.state.isLoading;return/*#__PURE__*/React.createElement(\"div\",{className:\"container\"},/*#__PURE__*/React.createElement(TitleComponent,{title:\"React CRUD Login \"}),/*#__PURE__*/React.createElement(\"div\",{className:\"card card-login mx-auto mt-5 \"},/*#__PURE__*/React.createElement(\"div\",{className:\"card-header colour-green\"},\"Login\"),/*#__PURE__*/React.createElement(\"div\",{className:\"card-body \"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleSubmit},/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-label-group\"},/*#__PURE__*/React.createElement(\"input\",{className:\"form-control \"+(this.state.authError?\"is-invalid\":\"\"),id:\"inputEmail\",placeholder:\"Email\",type:\"text\",name:\"email\",onChange:this.handleEmailChange,autoFocus:true,required:true}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"inputEmail\"},\"Email address\"),/*#__PURE__*/React.createElement(\"div\",{className:\"invalid-feedback\"},\"Please provide a valid Email.\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"div\",{className:\"form-label-group\"},/*#__PURE__*/React.createElement(\"input\",{type:\"password\",className:\"form-control \"+(this.state.authError?\"is-invalid\":\"\"),id:\"inputPassword\",placeholder:\"******\",name:\"password\",onChange:this.handlePwdChange,required:true}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"inputPassword\"},\"Password\"),/*#__PURE__*/React.createElement(\"div\",{className:\"invalid-feedback\"},\"Please provide a valid Password.\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"form-group\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn btn-primary btn-block\",type:\"submit\",disabled:this.state.isLoading?true:false},\"Login \\xA0\\xA0\\xA0\",isLoading?/*#__PURE__*/React.createElement(\"span\",{className:\"spinner-border spinner-border-sm\",role:\"status\",\"aria-hidden\":\"true\"}):/*#__PURE__*/React.createElement(\"span\",null)))),/*#__PURE__*/React.createElement(\"div\",{className:\"text-center\"},/*#__PURE__*/React.createElement(Link,{className:\"d-block small mt-3\",to:\"register\"},\"Register an Account\")))),this.renderRedirect());}}]);return Login;}(Component);export{Login as default};","map":{"version":3,"sources":["/home/parth/Documents/Github/resourcified-frontend/src/pages/login.js"],"names":["React","Component","axios","Link","Redirect","TitleComponent","configData","Login","state","email","password","redirect","authError","isLoggedin","location","handleEmailChange","event","setState","target","value","handlePwdChange","handleSubmit","preventDefault","isLoading","options","headers","url","SERVER_URL","bodyFormData","FormData","set","post","then","result","console","log","data","localStorage","setItem","id","token","role","getItem","institute","branch","full_name","status","catch","error","renderRedirect"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport axios from \"axios\";\nimport { Link, Redirect } from \"react-router-dom\";\nimport TitleComponent from \"./title\";\nimport configData from \"./config.json\";\n\nexport default class Login extends Component {\n  state = {\n    email: \"\",\n    password: \"\",\n\n    redirect: false,\n    authError: false,\n    isLoggedin: false,\n    location: {},\n  };\n  \n\n  handleEmailChange = (event) => {\n    this.setState({ email: event.target.value });\n  };\n  handlePwdChange = (event) => {\n    this.setState({ password: event.target.value });\n  };\n\n  handleSubmit = (event) => {\n    event.preventDefault();\n\n    this.setState({ isLoading: true });\n    const options = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    };\n    const url = `${configData.SERVER_URL}api/login`;\n\n    const email = this.state.email;\n    const password = this.state.password;\n    let bodyFormData = new FormData();\n    bodyFormData.set(\"email\", email);\n    bodyFormData.set(\"password\", password);\n    axios\n      .post(url, bodyFormData)\n      .then((result) => {\n       \n       \n        console.log(result.data);\n        localStorage.setItem(\"userid\", result.data.id);\n        localStorage.setItem(\"token\", result.data.token);\n        localStorage.setItem(\"role\", result.data.role);\n        console.log(localStorage.getItem(\"role\"));\n        localStorage.setItem(\"institute\", result.data.institute);\n        localStorage.setItem(\"branch\", result.data.branch);\n        localStorage.setItem(\"full_name\", result.data.full_name);\n        this.setState({ redirect: true, isLoggedin: true });\n        localStorage.setItem(\"isLoggedIn\", true);\n\n        if (result.data.status !== \"fail\") {\n          this.setState({ redirect: true, authError: false });\n        } else {\n          this.setState({ redirect: false, authError: true });\n        }\n\n      })\n      .catch((error) => {\n        console.log(error);\n        this.setState({ authError: true, isLoading: false });\n      });\n\n  };\n\n\n  renderRedirect = () => {\n\n    if (this.state.redirect) {\n\n\n      return <Redirect to=\"/branches\" />;\n\n\n\n    }\n\n  };\n\n  render() {\n    const isLoading = this.state.isLoading;\n\n    return (\n      <div className=\"container\">\n        <TitleComponent title=\"React CRUD Login \"></TitleComponent>\n        <div className=\"card card-login mx-auto mt-5 \">\n          <div className=\"card-header colour-green\">Login</div>\n\n          <div className=\"card-body \">\n            <form onSubmit={this.handleSubmit}>\n              <div className=\"form-group\">\n                <div className=\"form-label-group\">\n                  <input\n                    className={\n                      \"form-control \" +\n                      (this.state.authError ? \"is-invalid\" : \"\")\n                    }\n                    id=\"inputEmail\"\n                    placeholder=\"Email\"\n                    type=\"text\"\n                    name=\"email\"\n                    onChange={this.handleEmailChange}\n                    autoFocus\n                    required\n                  />\n                  <label htmlFor=\"inputEmail\">Email address</label>\n                  <div className=\"invalid-feedback\">\n                    Please provide a valid Email.\n                  </div>\n                </div>\n              </div>\n              <div className=\"form-group\">\n                <div className=\"form-label-group\">\n                  <input\n                    type=\"password\"\n                    className={\n                      \"form-control \" +\n                      (this.state.authError ? \"is-invalid\" : \"\")\n                    }\n                    id=\"inputPassword\"\n                    placeholder=\"******\"\n                    name=\"password\"\n                    onChange={this.handlePwdChange}\n                    required\n                  />\n                  <label htmlFor=\"inputPassword\">Password</label>\n                  <div className=\"invalid-feedback\">\n                    Please provide a valid Password.\n                  </div>\n                </div>\n              </div>\n\n              <div className=\"form-group\">\n                <button\n                  className=\"btn btn-primary btn-block\"\n                  type=\"submit\"\n                  disabled={this.state.isLoading ? true : false}\n                >\n                  Login &nbsp;&nbsp;&nbsp;\n                  {isLoading ? (\n                    <span\n                    className=\"spinner-border spinner-border-sm\"\n                      role=\"status\"\n                      aria-hidden=\"true\"\n                    ></span>\n                  ) : (\n                    <span></span>\n                  )}\n                </button>\n              </div>\n            </form>\n            <div className=\"text-center\">\n              <Link className=\"d-block small mt-3\" to={\"register\"}>\n                Register an Account\n              </Link>\n\n            </div>\n          </div>\n        </div>\n        {this.renderRedirect()}\n      </div>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}